<Page x:Class="WEMMWpf.Pages.WendingMachinesPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:WEMMWpf.Pages"
      mc:Ignorable="d" 
      d:DesignHeight="450"
      Title="WendingMachinesPage" Loaded="MachinePage_Loaded">

    <Canvas>
        <DockPanel x:Name="WendingMachinesDockPanel" Width="896" Height="650"
                   HorizontalAlignment="Left"
                   VerticalAlignment="Center"
                   Background="White"
                   MouseLeftButtonDown="WendingMachinesDockPanel_MouseLeftButtonDown"
                   MouseLeftButtonUp="WendingMachinesDockPanel_MouseLeftButtonUp"
                   MouseMove="WendingMachinesDockPanel_MouseMove"
                   Canvas.Left="{Binding WendingMachineDockPanelX}"
                   Canvas.Top="{Binding WendingMachineDockPanelY}">
            <!--Canvas.Left="{Binding WendingMachineDockPanelX}"
Canvas.Top="{Binding WendingMachineDockPanelY}">-->
            <DockPanel DockPanel.Dock="Top">
                <StackPanel>
                    <TextBlock Text="Торговые автоматы"
                           FontSize="18"
                           Foreground="#1099ff"
                           Margin="5,5,5,0"/>
                    <TextBlock x:Name="SearchResultTextBlock" Text="Всего найдено 0 шт" Margin="5,0,5,5"/>
                </StackPanel>
                <StackPanel DockPanel.Dock="Right"
                            Orientation="Horizontal"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Right"
                            Margin="0,0,5,0">
                    <Button x:Name="HideButton" Width="20" Click="HideButton_Click">
                        <Image x:Name="HideButtonImage" Source="/Images/blueEye.png"/>
                    </Button>
                    <Button x:Name="GridViewButton" Content="⊞" Foreground="#1099ff" Width="20"/>
                    <Button x:Name="BlockViewButton" Content="≡" Width="20"/>
                </StackPanel>
            </DockPanel>
            <DockPanel x:Name="MachinesDockPanel">
                <DockPanel DockPanel.Dock="Top">
                    <StackPanel DockPanel.Dock="Left" Orientation="Horizontal">
                        <TextBlock Text="Показать" Margin="5" VerticalAlignment="Center"/>
                        <TextBox Name="PageSizeTextBlock" Width="40"
                             HorizontalAlignment="Left"
                             Margin="2"
                             VerticalAlignment="Center"
                             TextChanged="PageSizeTextBlock_TextChanged"/>
                        <TextBlock Text="записей" Margin="5" VerticalAlignment="Center"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                        <Button x:Name="CreateButton" Margin="2" Click="CreateButton_Click">
                            <StackPanel Orientation="Horizontal">
                                <Image Source="/Images/plus.png" Width="20" Margin="2,2,5,0"/>
                                <TextBlock Text="Создать" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Button x:Name="ExportButton" Margin="2">
                            <StackPanel Orientation="Horizontal">
                                <Image Source="/Images/share.png" Width="20" Margin="2,2,5,0"/>
                                <TextBlock Text="Экспорт" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="Фильтер" Margin="5" VerticalAlignment="Center"/>
                        <TextBox x:Name="FilterTextBox" Width="200" Margin="2" VerticalAlignment="Center" TextChanged="FilterTextBox_TextChanged"/>
                    </StackPanel>
                </DockPanel>
                <DockPanel DockPanel.Dock="Bottom">
                    <StackPanel Orientation="Horizontal"
                                DockPanel.Dock="Right"
                                Margin="0,0,5,0">
                        <Button x:Name="BackButton" Content="◁" VerticalAlignment="Center" Width="20" Click="BackButton_Click"/>
                        <TextBox x:Name="PageTextBox" Background="#1099ff"
                             VerticalAlignment="Center"
                             Width="22" Height="22"
                             Text="1"
                             TextAlignment="Center"
                             Foreground="White"
                             IsReadOnly="True"/>
                        <Button x:Name="NextButton" Content="▷" VerticalAlignment="Center" Width="20" Click="NextButton_Click"/>
                    </StackPanel>
                    <TextBlock x:Name="RecordsTextBlock" Text="Записи с 0 по 0 из 0 записей" Margin="5,20,5,5"/>
                </DockPanel>
                <DataGrid x:Name="MachinesDataGrid"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          ItemsSource="{Binding MachineDtos}"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          AlternationCount="2"
                          RowBackground="#F2F2F2"
                          AlternatingRowBackground="White"
                          Margin="5">
                    <DataGrid.Resources>
                        <Style TargetType="TextBlock" x:Key="WrapStyle">
                            <Setter Property="TextWrapping" Value="Wrap"/>
                        </Style>
                    </DataGrid.Resources>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding SerialNumber}" MaxWidth="60"
                                        ElementStyle="{StaticResource WrapStyle}"/>
                        <DataGridTextColumn Header="Название автомата" Binding="{Binding Name}" MaxWidth="160" 
                                        ElementStyle="{StaticResource WrapStyle}"/>
                        <DataGridTextColumn Header="Модель" Binding="{Binding ModelName}" MaxWidth="100"
                                        ElementStyle="{StaticResource WrapStyle}"/>
                        <DataGridTextColumn Header="Компания" Binding="{Binding CompanyName}" MaxWidth="100"
                                        ElementStyle="{StaticResource WrapStyle}"/>
                        <DataGridTextColumn Header="Модем" Binding="{Binding Modem}" MaxWidth="71"
                                        ElementStyle="{StaticResource WrapStyle}"/>
                        <DataGridTextColumn Header="Адрес / Место" Binding="{Binding FullAddress}" MaxWidth="170"
                                        ElementStyle="{StaticResource WrapStyle}"/>
                        <DataGridTextColumn Header="В работе с" Binding="{Binding InstallDate, StringFormat='dd.MM.yyyy'}" MaxWidth="160"
                                        ElementStyle="{StaticResource WrapStyle}"/>
                        <DataGridTemplateColumn Header="Действия" MaxWidth="75">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" 
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center">
                                        <Image Source="/Images/bluepencil.png" Width="25"/>
                                        <Image Source="/Images/bluetrash.png" Width="25"/>
                                        <Image Source="/Images/blueunlock.png" Width="25"/>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </DockPanel>
        </DockPanel>
    </Canvas>
</Page>
